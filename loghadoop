package com.example.logtest;

import org.apache.log4j.Logger;
import org.apache.log4j.PropertyConfigurator;

public class LogGenerator {

    // Use different loggers for different appenders
    private static final Logger rootLogger = Logger.getRootLogger();
    private static final Logger securityLogger = Logger.getLogger("org.apache.ranger.plugin.policyengine.RangerPolicyEngineImpl");
    private static final Logger hdfsAuditLogger = Logger.getLogger("org.apache.hadoop.hdfs.server.namenode.FSNamesystem.audit");
    private static final Logger mapredAuditLogger = Logger.getLogger("org.apache.hadoop.mapred.AuditLogger");
    private static final Logger timelineLogger = Logger.getLogger("com.flipkart.fdp.greensight.collector.timeline.v1.writer.LoggerTimelineWriter");

    public static void main(String[] args) throws InterruptedException {
        // Load your log4j.properties
        PropertyConfigurator.configure("resources/log4j.properties");

        System.out.println("Starting Log Generator...");

        // Generate logs continuously
        for (int i = 1; i <= 10000; i++) {
            rootLogger.info("Root log message #" + i);
            securityLogger.warn("Security warning #" + i);
            hdfsAuditLogger.info("HDFS audit log #" + i);
            mapredAuditLogger.info("MapReduce audit log #" + i);
            timelineLogger.info("Timeline log #" + i);

            // Sleep to simulate time-based rotation
            Thread.sleep(50); // 50ms
        }

        System.out.println("Log generation completed.");
    }
}
